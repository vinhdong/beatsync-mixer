<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BeatSync Mixer</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://sdk.scdn.co/spotify-player.js"></script>
</head>
<body>

<!-- Fixed top Spotify player for hosts -->
<div id="playback-section">
  <div id="now-playing">
    <div id="album-art">
      <div id="no-track-placeholder">🎵</div>
      <img id="album-image" alt="Album Art" style="display: none;">
    </div>
    <div id="track-info">
      <div id="current-track-name">No track playing</div>
      <div id="current-track-artist">Connect to start playback</div>
    </div>
  </div>
  
  <div id="playback-controls">
    <button id="prev-btn" onclick="previousTrack()">⏮️</button>
    <button id="play-pause-btn" onclick="togglePlayback()">▶️</button>
    <button id="next-btn" onclick="nextTrack()">⏭️</button>
  </div>
  
  <div id="progress-container" onclick="seekToPosition(event)">
    <div id="progress-bar">
      <div id="progress-fill"></div>
    </div>
    <div id="time-info">
      <span id="current-time">0:00</span>
      <span id="total-time">0:00</span>
    </div>
  </div>
  
  <div id="volume-control">
    <span>🔊</span>
    <input type="range" id="volume-slider" min="0" max="100" value="50" oninput="setVolume(this.value)">
  </div>
  
  <div id="connection-status">🔴 Not connected</div>
</div>

<!-- Main content area -->
<div class="main-content">
  <!-- Header container with title and buttons -->
  <div class="header-container">
    <h1>🎵 BeatSync Mixer</h1>
    <div class="header-buttons">
      <button id="host-restart-btn" onclick="restartSession()" style="display: none;">🔄 Restart Session</button>
    </div>
  </div>
  
  <!-- Role selection and login -->
  <div id="login" style="display: none;">
    <div class="role-selection">
      <h2>Choose Your Role</h2>
      <div class="role-buttons">
        <a href="/auth/spotify" class="role-btn host-btn">
          <div class="role-icon">🎧</div>
          <h3>Host</h3>
          <p>Connect your Spotify and control the music</p>
        </a>
        <a href="/auth/listener" class="role-btn listener-btn">
          <div class="role-icon">👂</div>
          <h3>Listener</h3>
          <p>Join with Spotify to add songs and vote</p>
        </a>
        <button onclick="continueAsGuest()" class="role-btn guest-btn">
          <div class="role-icon">👤</div>
          <h3>Guest</h3>
          <p>Just vote and chat, no sign-up required</p>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Content grid layout -->
  <div class="content-grid">
    <!-- Playlists and tracks section -->
    <div class="playlists-tracks-section">
      <div id="playlists" style="display: none;">
        <h2>Your Playlists</h2>
        <ul id="playlist-list"></ul>
      </div>

      <div id="tracks" style="display: none;">
        <h2>Playlist Tracks</h2>
        <button id="back-btn">← Back to Playlists</button>
        <ul id="track-list"></ul>
      </div>
    </div>

    <!-- Queue section -->
    <div id="queue-section">
      <h2>🎵 Queue</h2>
      <div id="queue-empty" style="display: block;">
        <p>No tracks in queue yet. Add some music to get started!</p>
      </div>
      <ul id="queue"></ul>
      <button id="clear-queue-btn" onclick="clearQueue()" style="display: none;">🗑️ Clear Queue</button>
    </div>
  </div>
</div>

<!-- Floating Chat Box -->
<div id="floating-chat">
  <div id="chat-header" onclick="toggleChat()">
    <span>💬 Chat</span>
    <button id="chat-toggle">−</button>
  </div>
  <div id="chat-content">
    <div id="chat-messages"></div>
    <form id="chat-form" onsubmit="sendChatMessage(event)">
      <input type="text" id="chat-input" placeholder="Type a message..." maxlength="200">
      <button type="submit">Send</button>
    </form>
  </div>
</div>

<script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
<script src="js/app.js"></script>
</body>
</html>
